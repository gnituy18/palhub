extends ../../views/layout
include ../../views/mixin

block head
  +title('Login')

block scripts
  +script('/js/login.js')
  script.
    ga('send', 'pageview')
  script.
    const div = window.document.createElement('div');
    div.innerHTML = parseAccessToken(window.location.href)
    window.document.getElementsByClassName('center')[0].appendChild(div);

    function parseAccessToken(url){
      const tokenString = url.match(/access_token=\w*/)
      if(tokenString !== null){
        alert(tokenString)
        document.getElementById('loginbtn').innerHTML = 'haha'
        return tokenString[0].split('=')[1]
      } else {
        document.getElementById('loginbtn').innerHTML = 'no'
        return 'nothing'
      }
    }
    
block content
  div(id='fb-root')
  div(class='wrapper')
    div(class='center')
      h2 請登入你的Facebook帳號
      a(id="loginbtn" href='https://www.facebook.com/v2.10/dialog/oauth?client_id=435861663458019&redirect_uri=https://palhub.net/login&response_type=token') login button
      div(onlogin="window.checkLoginState();" style="display:none" class="fb-login-button" data-max-rows="1" data-size="large" data-button-type="continue_with" data-show-faces="false" data-auto-logout-link="false" data-use-continue-as="false")
    
